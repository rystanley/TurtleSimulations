geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=2)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=2)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2,lwd=1.4)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=2,lwd=1.4)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2,lwd=1.15)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=2,lwd=1.15)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=2,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13+annotation("1996",x=35,y=190,angle=90)
p13+annotate("1996",x=35,y=190,angle=90)
p13+annotate("text",x=35,y=190,label="1996",angle=90)
p13+annotate("text",x=190,y=35,label="1996",angle=90)
rep(5,7)
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,7),x=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,7),
x=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
labels=c("1996","1999","2002","2005","2008","2011","2015"))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,7),
x=cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"],
labels=c("1996","1999","2002","2005","2008","2011","2015"))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),"cum_effort"]
cEffort
cEffort[which(cEffort$year %in% c(1996,1999,2002,2005,2008,2011,2015)),]
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,7),
x=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"],
labels=c("1996","2000","2005","2009","2012","2015"))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
4000*150
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"],
labels=c("1996","2000","2005","2009","2012","2015"))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"],
label=c("1996","2000","2005","2009","2012","2015"))+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2005,2009,2012,2015)),"cum_effort"],
label=c("1996","2000","2005","2009","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (people hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
ggsave("Asymptote_NumberTurtles_scaled.png",p13,height = 7,width = 7)
p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=2)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"],
label=c("1996","2002","2008","2014"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=2)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(17,4),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"],
label=c("1996","2002","2008","2014"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=2)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(40,4),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2014)),"cum_effort"],
label=c("1996","2002","2008","2014"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=2)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(40,5),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"],
label=c("1996","2002","2008","2012","2015"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=2)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(40,5),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"],
label=c("1996","2002","2008","2012","2015"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=1)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (people hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
ggsave("Asymptote_EffortvsNumberTurtles_fitted.png",p12fitted,height=7,width=7)
cEffort
Effort <- NULL
for (i in unique(df$year)){
tempdat <- subset(df,year==i)
cumEffort <- data.frame(year=i,cum_effort=tempdat[nrow(tempdat),"cum_effort"])
cEffort <- rbind(cEffort,cumEffort)
}
Effort
head(df)
tempdat
Effort <- NULL
for (i in unique(df$year)){
tempdat <- subset(df,year==i)
cumEffort <- data.frame(year=i,cum_effort=tempdat[nrow(tempdat),"cum_effort"])
Effort <- rbind(Effort,cumEffort)
}
Effort
mean(Effort$cum_effort)
plot(cum_effort~year,data=Effort)
mean(Effort[-nrow(Effort),"cum_effort"])
mean(Effort[-nrow(Effort),"cum_effort"])/60
900/mean(Effort[-nrow(Effort),"cum_effort"])/60
900/(mean(Effort[-nrow(Effort),"cum_effort"])/60)
each year
cEffort <- NULL
for (i in unique(df2$year)){
tempdat <- subset(df2,year==i)
cumEffort <- data.frame(year=i,cum_effort=tempdat[nrow(tempdat),"cum_effort"])
cEffort <- rbind(cEffort,cumEffort)
}
p12fitted <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+theme_bw()+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(40,5),
x=cEffort[which(cEffort$year %in% c(1996,2002,2008,2012,2015)),"cum_effort"],
label=c("1996","2002","2008","2012","2015"),angle=90)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_point(size=3)+
geom_hline(aes(yintercept=number.unique),lty=2)+
geom_segment(aes(x=inflectionpoint,xend=inflectionpoint,
y=dat2[which.min(abs(dat2$cum_effort - inflectionpoint)),"total_turtles"],yend=0),lty=1)+
geom_line(data=dat2,lwd=1.13,col="grey50")+
labs(y="Number of turtles",x="Sampling effort (observational hours)")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0))+
scale_x_continuous(breaks=c(0,inflectionpoint,2000,4000,6000),
labels=c(0,round(inflectionpoint),2000,4000,6000));p12fitted
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (observational hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p10a <- ggplot(df,aes(x=cum_effort/60,y=total_turtles))+geom_point()+
theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2)+
labs(x="Cumulative sampling effort (observational hours)",y="Number of unique turtle observations")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)));p10a
#2015 was an anomlous year with the most effort sustained over the longest period and this scews the results
p10b <- ggplot(filter(df,year!=2015),aes(x=cum_effort/60,y=total_turtles))+geom_point()+
theme_bw()+theme(legend.position="none")+
stat_smooth()+geom_hline(aes(yintercept=number.unique),lty=2)+
labs(x="Cumulative sampling effort (observational hours)",y="Number of unique turtle observations")+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)));p10b
#wrapped for each year
p11a <-  ggplot(df,aes(x=cum_effort/60,y=total_turtles))+geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth(span=600)+facet_wrap(~year,nrow=10)+scale_y_continuous(limits=c(0,30))+
labs(x="Cumulative sampling effort (observational hours)",y="Number of unique turtle observations");p11a
p11b <- ggplot(filter(df,year!=2015),aes(x=cum_effort,y=total_turtles))+geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth(span=600)+facet_wrap(~year,nrow=10)+scale_y_continuous(limits=c(0,30))+
labs(x="Cumulative sampling effort (observational hours)",y="Number of unique turtle observations");p11b
## save plots
ggsave("UniqueTurtles~Effort_byYear_composite.png",p10a,width=7,height=7)
ggsave("UniqueTurtles~Effort_byYear_composite_no2015.png",p10b,width=7,height=7)
ggsave("UniqueTurtles~Effort_byYear_facet.png",p11a,width=7,height=9.5)
ggsave("UniqueTurtles~Effort_byYear_facet_no2015.png",p11b,width=7,height=7)
p8 <- ggplot(filter(simdata2,nsamp==10),aes(x=effort/60,y=meanturtles))+geom_boxplot()+theme_bw()+
labs(x="Sampling effort (total observatioal hours)",y="Number of turtles");p4
p9 <- ggplot(filter(ave.numturtles2,nsamp==10),aes(x=effort/60,y=mean,group=1))+
geom_point()+geom_errorbar(aes(ymin=mean-sd,ymax=mean+sd),width=0.2)+
geom_line()+theme_bw()+labs(x="Sampling effort (total observational hours)",y="Mean # of turtles Â± sd");p9
## save plots
ggsave("NumberTurtles~Effort.png",p8,width=7,height=7)
ggsave("MeanNumberTurtles~Effort.png",p9,width=7,height=7)
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth(span=75)+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (observational hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth(span=25)+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (observational hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
p13 <- ggplot(df2,aes(x=cum_effort,y=total_turtles))+
geom_vline(aes(xintercept=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"]),
lty=2,col="grey50",lwd=0.5)+
annotate("text",y=rep(5,6),
x=cEffort[which(cEffort$year %in% c(1996,2000,2004,2008,2012,2015)),"cum_effort"],
label=c("1996","2000","2004","2008","2012","2015"),angle=90)+
geom_point()+theme_bw()+theme(legend.position="none")+
stat_smooth(span=5)+geom_hline(aes(yintercept=number.unique),lty=1,lwd=1)+
scale_x_log10(breaks=c(10,100,1000,df2[which(df2$total_turtles==number.unique)[1],"cum_effort"]),
labels=c(10,100,1000,round(df2[which(df2$total_turtles==number.unique)[1],"cum_effort"])))+
annotation_logticks(sides="b")+labs(y="Number of turtles",x="Sampling effort (observational hours)")+
geom_segment(aes(x=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
xend=df2[which(df2$total_turtles==number.unique)[1],"cum_effort"],
y=number.unique,yend=0),lty=1,lwd=1)+
scale_y_continuous(limits=c(0,mround(number.unique,5)),
breaks=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
labels=c(seq(0,round(number.unique/10)*10,5),number.unique,mround(number.unique,5)),
expand = c(0,0));p13
4428/450
